sourceSets {
	integTest {
		groovy.srcDir file('src/integTest/groovy')
		resources.srcDir file('src/integTest/resources')
		compileClasspath = sourceSets.main.output + configurations.testRuntime
		runtimeClasspath = output + compileClasspath
	}
}

task integTest(type: Test) {
	testClassesDir = sourceSets.integTest.output.classesDir
	classpath = sourceSets.integTest.runtimeClasspath
	reports.html.destination = file("$buildDir/reports/integTest")

	testLogging {
		events "failed"
		exceptionFormat "full"
	}
}

task jacocoIntegTestReport(type: JacocoReport) {
	sourceSets sourceSets.main
	executionData integTest
	reports.html.destination "${buildDir}/reports/jacocoIntegTestReport"
}

integTest.finalizedBy jacocoIntegTestReport